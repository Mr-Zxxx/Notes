# 开发文档编写

### 第一层：最简可运行（MVP 必备）

| 文档           | 目的                       | 典型文件/位置                                   | 工具示例                |
| :------------- | :------------------------- | :---------------------------------------------- | :---------------------- |
| README.md      | 新人 5 分钟跑起来          | 根目录                                          | Markdown                |
| 环境清单       | 一键还原开发/测试/生产环境 | `docs/ENV.md` + Docker Compose / Nix / Brewfile | Docker, Nix             |
| 构建与部署脚本 | CI/CD 可重复               | `.github/workflows/`, `Makefile`, `deploy.sh`   | GitHub Actions, Jenkins |
| CHANGELOG.md   | 用户可见的变更记录         | 根目录                                          | Keep a Changelog 规范   |

> ✅ 小团队（<5 人）先保证这 4 个文件存在，就能做到“任何新人 30 分钟能跑起来”。

------

### 第二层：长期可维护（上线后必须补齐）

| 类别          | 文档                | 面向对象       | 关键内容                                 | 推荐工具                          |
| :------------ | :------------------ | :------------- | :--------------------------------------- | :-------------------------------- |
| **需求/产品** | PRD（产品需求文档） | 产品经理、客户 | 业务流程、角色权限、验收标准             | Notion、飞书多维表                |
| **技术设计**  | 系统架构图          | 全团队         | C4 Model（上下文、容器、组件、代码）     | draw.io、Structurizr              |
|               | ADR（架构决策记录） | 技术骨干       | “为什么用 Kafka 而不是 RabbitMQ”         | Markdown + `docs/adr/0001-xxx.md` |
|               | ER 图 / API 契约    | 前后端         | OpenAPI/Swagger、dbdiagram.io            | Swagger UI、dbdocs                |
| **代码级**    | 代码注释 & 类型     | 开发者         | JSDoc / TypeDoc / docstring              | IDE 自动生成                      |
|               | 模块 README         | 开发者         | 每个微服务/模块的入口、配置              | 同仓库                            |
| **测试**      | 测试策略            | QA、Dev        | 单元/接口/E2E 范围、测试数据             | `docs/TEST.md`                    |
|               | 回归测试用例        | QA             | 核心场景清单                             | TestLink、禅道                    |
| **运维**      | 运行手册（Runbook） | DevOps、值班   | 日志位置、重启命令、回滚步骤             | `docs/RUNBOOK.md`                 |
|               | 监控告警规则        | DevOps         | Prometheus rules、Grafana dashboard 链接 | YAML + README                     |
| **安全**      | 威胁建模报告        | 安全团队       | STRIDE、数据流图                         | Microsoft TMT                     |
|               | 依赖漏洞清单        | 全团队         | `pnpm audit`, `trivy` 报告               | GitHub Dependabot                 |

------

### 第三层：组织级治理（多项目/多团队协作）

| 文档                     | 目的          | 维护频率   | 工具                                |
| :----------------------- | :------------ | :--------- | :---------------------------------- |
| 产品路线图（Roadmap）    | 对齐商业目标  | 每季度     | Jira、ProductPlan                   |
| 技术债 Backlog           | 防止腐烂      | 每月       | Jira label: tech-debt               |
| 编码规范                 | 统一风格      | 每年       | ESLint/Prettier + `CONTRIBUTING.md` |
| 发布流程（Release Flow） | 灰度/回滚策略 | 每次大版本 | GitFlow 或 GitHub Flow 文档         |
| 灾难恢复计划（DRP）      | 机房/云故障   | 每半年     | `docs/DR.md` + 演练记录             |
| 数据字典 & 隐私合规      | GDPR/国密合规 | 随迭代     | OneTrust、自研表格                  |
| 交接文档（Handover）     | 人员流动      | 离职前     | Confluence 模板                     |

------

### 📁 目录模板（可直接用）

```
repo-root/
├── README.md
├── CHANGELOG.md
├── docs/
│   ├── ENV.md
│   ├── RUNBOOK.md
│   ├── TEST.md
│   ├── adr/
│   │   └── 0001-use-kafka-for-events.md
│   └── arch/
│       ├── c4-context.png
│       └── openapi.yaml
├── .github/workflows/ci.yml
└── CONTRIBUTING.md
```

------

### 落地建议

1. **先写“五分钟上手” README**，其他文档按故障/新人/交接痛点逐步补。
2. **文档即代码**：把 ADR、API 契约、监控规则全部进 Git，MR 评审强制更新。
3. **设立单一可信源**：需求用 Notion → 自动生成 Jira 任务 → 代码注释反向链接 PRD。
4. **每季度“文档可用性演练”**：随机抽新人 30 分钟从零搭建环境，失败就补文档。





# 数据库设计

表需要遵守表功能单一职责

需要考虑的数据的流动方向性，保证逻辑上的操作同意，例如关注功能

对于指定类型枚举类型查询效率更高

# Thinkphp



# Vue

### Vue 3 生命周期钩子

| 钩子                  | 用法说明                                                     | 注意事项 / 推荐场景                                       |
| --------------------- | ------------------------------------------------------------ | --------------------------------------------------------- |
| **setup()**           | 组件创建时执行，进行初始化，替代 `beforeCreate` 和 `created` | 这里不能访问 `this`，应使用组合式 API（ref、reactive 等） |
| **onBeforeMount()**   | 挂载前执行                                                   | 一般用得少，准备挂载相关数据                              |
| **onMounted()**       | 挂载完成，DOM 渲染完成                                       | 操作 DOM、调用第三方库的初始化                            |
| **onBeforeUpdate()**  | 数据变化触发视图更新前                                       | 不要在这里改响应式数据，避免死循环                        |
| **onUpdated()**       | 视图更新完成后                                               | 操作更新后的 DOM                                          |
| **onBeforeUnmount()** | 组件卸载前                                                   | 做资源释放、解绑事件等清理工作                            |
| **onUnmounted()**     | 组件卸载后                                                   | 已不能访问响应式数据                                      |
| **onActivated()**     | keep-alive 组件激活                                          | 恢复数据、重新发请求                                      |
| **onDeactivated()**   | keep-alive 组件停用                                          | 暂停定时器、保存状态                                      |

![组件生命周期图示](./assets/lifecycle_zh-CN.W0MNXI0C.png)



### 隐藏滚动条

| 浏览器        | 隐藏滚动条的方法                         |
| ------------- | ---------------------------------------- |
| Chrome/Safari | `::-webkit-scrollbar { display: none; }` |
| Firefox       | `scrollbar-width: none;`                 |
| IE/Edge       | `-ms-overflow-style: none;`              |



------

**⚠️ 注意：**

- 虽然滚动条不可见，但用户可以用 **鼠标滚轮 / 触摸板 / 手指滑动 / 键盘方向键** 来滚动。
- 不建议用于用户必须明确知道可滚动的区域，除非你能用箭头提示或动画引导用户。



# MapLibre GL JS

**MapLibre GL JS**（一个开源的 Web 地图库，与 Mapbox GL JS 兼容）



# ffmpeg

处理视频工具，可以用于截取视频封面



# 远程SSH开发

秘钥：

```
PS C:\Users\Admin> ssh-keygen -t rsa -b 4096
Generating public/private rsa key pair.
Enter file in which to save the key (C:\Users\Admin/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in C:\Users\Admin/.ssh/id_rsa        
Your public key has been saved in C:\Users\Admin/.ssh/id_rsa.pub        
The key fingerprint is:
SHA256:gPoeX7hrO8Rrr1HgG+wUIFJZIMlT1gy6vOtuMlsm8Mo admin@DESKTOP-6A52IHN
The key's randomart image is:
+---[RSA 4096]----+
|+o=B*            |
|.=+. =           |
| .. . +          |
|. .. o +         |
|.o.  .= S        |
|.... oo=         |
|..+ o.=..        |
|+*.. o=+         |
|BE  .o**.        |
+----[SHA256]-----+
PS C:\Users\Admin> 

```



# 推送拉去数据去重最简方案

去重最简落地方案（≤ 1 MB 数据量通用）

小项目别一步到位抄 B 站那套“四层过滤”，**用最轻量的方案就能 99 % 解决**：

1. 后端接口一次性返回 **“最新 N 条” + 上次最后一条 id**
2. 前端用 **Set 去重** 就够了
3. 数据量不大，全量拉取，简单可靠

后端（伪代码）

```php
// 请求：GET /api/works?cursor=0&limit=20
$cursor = (int) request('cursor');
$list  = Work::orderBy('id','desc')
              ->where('id','<',$cursor)   // 只取比 cursor 小的
              ->limit(20)
              ->get();
return [
  'list' => $list,
  'next_cursor' => $list->last()->id ?? 0
];
```

前端（Vue/React 都一样）

```js
const ids = new Set();        // 会话级去重
const list = ref([]);

const loadMore = async () => {
  const { data } = await axios.get('/api/works', {
    params: { cursor: list.value.at(-1)?.id || 0, limit: 20 }
  });
  // 过滤重复
  const filtered = data.list.filter(item => !ids.has(item.id));
  filtered.forEach(item => ids.add(item.id));
  list.value.push(...filtered);
};
```

**小项目：后端给“游标+limit”接口，前端一个 Set 去重，20 行代码搞定，别上布隆过滤器。**



# JavaScript

### `??` （空值合并）

- 只在左边是 `null` 或 `undefined` 时才返回右边，其它情况直接返回左边。

```
console.log(0 ?? 100);     // 0   （不会被当成“空”）
console.log("" ?? "默认");  // ""  （保留空字符串）
console.log(null ?? "默认"); // "默认"
console.log(undefined ?? "默认"); // "默认"
```

### **可选链运算符（`?.`）**

可选链运算符 `?.` 用来 **安全地访问对象属性或调用方法**，避免因为 `null` 或 `undefined` 导致报错。

#### 用法

(1) **访问对象属性**

```
obj?.prop
```

- 如果 `obj` 存在，返回 `obj.prop`
- 如果 `obj` 是 `null` 或 `undefined`，返回 `undefined`

(2) **访问嵌套属性**

```
user?.address?.city
```

- 如果 `user` 或 `user.address` 是 `null`/`undefined`，直接返回 `undefined`

(3) **调用方法**

```
obj?.method?.()
```

- 如果 `obj.method` 存在，就执行
- 如果 `obj` 是 `null` 或方法不存在，不会报错，而是返回 `undefined`

(4) **访问数组元素**

```
arr?.[0]
```

- 如果 `arr` 存在，就取第一个元素
- 否则返回 `undefined`







# END



root

Visara@vr78